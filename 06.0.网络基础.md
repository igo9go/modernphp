#TCP/IP协议

###TCP/IP的基本概念

#####1、分层

TCP/IP通常是被分成四层协议系统的，应用层（Telnet、FTP和Email等）、运输层（TCP、UDP）、网络层（IP、ICMP、IGMP等）和链路层（设备驱动程序），每一层各司其职，下层对上层来说，是透明的。
    
![](http://oc9orpe44.bkt.clouddn.com/17-2-17/3786679-file_1487311785907_11bdb.png)
    上图是局域网上运行的FTP两台主机，在同一层上，双方都有对应的一个或多个协议进行通信。首先认识一下TCP/IP协议。
    TCP/IP通常指的是TCP/IP协议簇，是一组不同的协议组合在一起勾成的协议簇，上图中列举了四种不同层次的协议，F T P是一种应用层协议， T C P是一种运输层协议，I P是一种网络层协议，而以太网协议则应用于链路层上。
    在T C P / I P协议族中，网络层 I P提供的是一种不可靠的服务。也就是说，它只是尽可能快地把分组从源结点送到目的结点，但是并不提供任何可靠性保证。而另一方面， T C P在不可靠的I P层上提供了一个可靠的运输层。为了提供这种可靠的服务， T C P采用了超时重传、发送和接收端到端的确认分组等机制。
    
#####2、互联网的地址
互联网上每个接口都必须有一个唯一的Internet地址即IP地址，IPV4的地址长度是32bit，如下图分成五类：
![](http://oc9orpe44.bkt.clouddn.com/17-2-17/48558785-file_1487312002107_4bfe.png)
    - A类地址范围：0.0.0.0~127.255.255.255，
    - B类地址范围：128.0.0.0~191.255.255.255，
    - C类地址范围：192.0.0.0~223.255.255.255，
    - D类地址范围：224.0.0.0~239.255.255.255，
    - E类地址范围：240.0.0.0~247.255.255.255.
    
#####3、域名系统
在 T C P / I P领域中，域名系统（ D N S）是一个分布的数据库，由它来提供 I P地址和主机名之间的映射信息。
    
#####4、封装
当应用程序用 T C P传送数据时，数据被送入协议栈中，然后逐个通过每一层直到被当作一串比特流送入网络。其中每一层对收到的数据都要增加一些首部信息。以太网数据帧的物理特性是其长度必须在 4 6～1 5 0 0字节之间。
    
#####5、分用
当目的主机收到一个以太网数据帧时，数据就开始从协议栈中由底向上升，同时去掉各层协议加上的报文首部。每层协议盒都要去检查报文首部中的协议标识，以确定接收数据的上层协议。这个过程称作分用。
    
#####6、客户-服务器模型
大部分网络应用程序在编写时都假设一端是客户，另一端是服务器，其目的是为了让服务器为客户提供一些特定的服务。可以将这种服务分为两种类型：重复型或并发型。一般来说， T C P服务器是并发的，而 U D P服务器是重复的，但也存在一些例外。
    
#####7、端口号
T C P和U D P采用16 bit的端口号来识别应用程序，服务器一般都是通过知名端口号来识别的。例如，对于每个 T C P / I P实现来说，F T P服务器的T C P端口号都是2 1，每个Te l n e t服务器的T C P端口号都是2 3。U n i x系统的文件/e t c / s e r v i c e s都包含了人们熟知的端口号。查看：cat /etc/services | grep telnet
    
#####8、RFC
I n t e r n e t的正式标准都以R F C（Request for Comment）文档出版。另外，大量的R F C并不是正式的标准，出版的目的只是为了提供信息。 R F C的篇幅从1页到2 0 0页不等。每一项都用一个数字来标识，如 RFC 1 1 2 2，数字越大说明R F C的内容越新。
    
#####9、实现
既成事实标准的 T C P / I P软件实现来自于位于伯克利的加利福尼亚大学的计算机系统研究小组。从历史上看，软件
是随同4.x BSD系统（Berkeley SoftwareD i s t r i b u t i o n）的网络版一起发布的。它的源代码是许多其他实现的基础。

#####10、应用编程接口
使用T C P / I P协议的应用程序通常采用两种应用编程接口（ A P I）：s o c k e t和T L I（运输层接口：Transport Layer Interface ）。
